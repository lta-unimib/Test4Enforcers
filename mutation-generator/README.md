# Major mutation generator
The software allows easy operation of major tool to mutate and compile enforcers.

### Prerequisites
To run and compile enforcer mutations you will need:
- Bash
- Python 3
- Java 7 or Java 8 (both will work, the latter will output a non-blocking warning)
- Android SDK (required for the compilation phase only)
- Major ([Download](https://mutation-testing.org/downloads/))

## Generate
The generation process requires three paths to work:
  - **Major root path:** the major path location
  - **Enforcer source file:** the enforcer source code generated by Proactive libraries
  - **Mutations output path:** where to store mutants' sources generated by major

Customizations to the generation are supported through an external .mml script (which will be compiled automatically) or by selecting which types of mutations to apply.

The generate button will run major on the input source and will store the mutants in the ouput folder. The resulting mutations applied to the source code will be recorded and stored in an additional file named `mutants.log`.
The process is executed in a background thread.

## Compile
The compilation phase works in conjunction with the generation one. It requires to specify:
  - **Mutations input path:** where to find the mutants sources to compile (a copy button is provided for convenience).
  - **Enforcer base project:** the location of the bare android project used to compile the enforcer generated by Proactive libraries during the enforcer generation (this is usually stored under `modenforcer` folder in Proactive libraries' folder).
  - **APK output path:** where to store the generated apks.
  - **Mutants.log file:** the `mutants.log` file which contains information about the generates mutants. Used to estimate the number of generated mutants beforehand.

In addition, it is possible to restrict the number of compiled mutation by excluding them based on:
  - Logging calls replaced with NOP operations
  - Entire findAndHookMethods replaced with NOP operations
  - Stacktrace print in catches replaced with NOP operations
  - Source code line number greater than a specified threshold

After selecting an option, the GUI will show the number of mutation which will be attempted to be compiled. The resulting number of generated apks could vary based on compilation errors determined by the mutations (for example: try/catch block where the throwing instruction is replaced with a NOP).

This process will take some time based on the number of mutants to compile and will be executed in the main thread (the UI will freeze and will not respond until the process is complete). The compilation progress can be seen in the console where the python command was first executed to launch the GUI.

# Step by Step Mutation Generation
This section provides information about the process to generate and compile mutants given the original unmutated enforcer:

0. (optional) On Windows edit the `run.bat` file to point to the correct Java JRE folder that you want to use with the mutation generator.
1. Execute `main.py` (on Windows open `run.bat`)

### To generate mutants:
2. Select the "Generate" tab.
3. Provide the path where major framework was extracted.
4. Pick the enforcer's source file to mutate.
5. Select where to store sources of the mutants.
6. Do not select any "Enabled mutations"'s checkbox to apply all the mutation operators.
7. Press "Generate Mutants" button.

### To compile mutants:
8. Select the "Compile" tab.
9. Provide the folder which contains mutations' source code.
10. Pick the android project to use as a template to compile the enforcer to apk.
11. Choose the output path for the generated mutants apk.
11. Select the `mutants.log` file created during the generation phase.
12. Tick all the checkboxes in the "Exclude list" section.
13. In the enforcer source code, identify the line where method proxying begins (usually around line 300-350) and insert the number in the respective field.
14. Press the "Compile mutants" button.
